CREATE DATABASE RETAILS;
USE RETAIL;
use schema PUBLIC;

CREATE OR REPLACE TABLE demographic_RAW
(AGE_DESC	CHAR(20),
MARITAL_STATUS_CODE	CHAR(5),
INCOME_DESC	VARCHAR(40),
HOMEOWNER_DESC	VARCHAR(40),
HH_COMP_DESC	VARCHAR(50),
HOUSEHOLD_SIZE_DESC	VARCHAR(50),
KID_CATEGORY_DESC	VARCHAR(40),
household_key INT PRIMARY KEY
);

SELECT * FROM demographic_RAW; -- To get the entire table entry if you are in same database as the table

SELECT * FROM RETAIL.PUBLIC.DEMOGRAPHIC_RAW; -- To get the entire table entry if you are in different database than table

SELECT COUNT(*) FROM demographic_RAW; -- This will give total no. of records present in a table.

SELECT AGE_DESC,INCOME_DESC,MARITAL_STATUS_CODE,HOUSEHOLD_SIZE_DESC FROM demographic_RAW;-- Gives only the specified column after ------select keywork and respective data

SELECT AGE_DESC,INCOME_DESC,MARITAL_STATUS_CODE,HOUSEHOLD_SIZE_DESC 
FROM demographic_RAW
ORDER BY 1 ASC,2 DESC,4; --- In order by if not specified it will be arranged in Ascending order.

SELECT AGE_DESC,INCOME_DESC,MARITAL_STATUS_CODE,HOUSEHOLD_SIZE_DESC ---3rd
FROM demographic_RAW --- 1st 
WHERE income_desc = '125-149K'---2nd
ORDER BY 1 ASC,2 DESC,4;---4th

CREATE OR REPLACE FILE FORMAT CSV_header_1_delim_comma
    type = 'CSV'
    compression ='NONE'
    field_delimiter = ','
    field_optionally_enclosed_by = 'NONE'
    skip_header = 1 ;

Create or Replace Table TXN_MULTIPLE_CSV_LOAD like DEMO_DATABASE.PUBLIC."AD_Retail_TXN";


CREATE OR REPLACE TABLE CAMPAIGN_DESC_RAW
(DESCRIPTION CHAR(10),	
CAMPAIGN	INT ,
START_DAY	INT,
END_DAY INT,
PRIMARY KEY (DESCRIPTION),
UNIQUE (CAMPAIGN));




CREATE OR REPLACE TABLE CAMPAIGN_RAW
(DESCRIPTION	CHAR(10) ,
household_key	INT,
CAMPAIGN INT,
FOREIGN KEY (DESCRIPTION) references CAMPAIGN_DESC_RAW(DESCRIPTION) ,
FOREIGN KEY (CAMPAIGN) references CAMPAIGN_DESC_RAW(CAMPAIGN),
FOREIGN KEY (household_key) references demographic_RAW(household_key)
);

CREATE OR REPLACE TABLE PRODUCT_RAW
(PRODUCT_ID	INT PRIMARY KEY,
MANUFACTURER 	INT,
DEPARTMENT	VARCHAR(50),
BRAND	VARCHAR(30),
COMMODITY_DESC	VARCHAR(65),
SUB_COMMODITY_DESC VARCHAR(65)	,
CURR_SIZE_OF_PRODUCT VARCHAR(15)
);


CREATE OR REPLACE TABLE COUPON_RAW
(COUPON_UPC	INT,
PRODUCT_ID	INT,
CAMPAIGN INT,
FOREIGN KEY (PRODUCT_ID) references PRODUCT_RAW(PRODUCT_ID),
FOREIGN KEY (CAMPAIGN) references CAMPAIGN_DESC_RAW(CAMPAIGN)
);


CREATE OR REPLACE TABLE COUPON_REDEMPT_RAW
(household_key	INT,
DAY	INT,
COUPON_UPC	INT,
CAMPAIGN INT,
FOREIGN KEY (household_key) references demographic_RAW(household_key),
FOREIGN KEY (CAMPAIGN) references CAMPAIGN_DESC_RAW(CAMPAIGN)
);

CREATE OR REPLACE TABLE TRANSACTION_RAW 
(household_key	INT,
BASKET_ID	INT,
DAY	INT,
PRODUCT_ID	INT,
QUANTITY	INT,
SALES_VALUE	FLOAT,
STORE_ID	INT,
RETAIL_DISC	FLOAT,
TRANS_TIME	INT,
WEEK_NO	INT,
COUPON_DISC	INT,
COUPON_MATCH_DISC INT
-- FOREIGN KEY (PRODUCT_ID) references PRODUCT_RAW(PRODUCT_ID),
-- FOREIGN KEY (household_key) references demographic_RAW(household_key)
);

SELECT * FROM RETAIL.PUBLIC.TRANSACTION_RAW;
